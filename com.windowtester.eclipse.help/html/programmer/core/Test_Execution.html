<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content=
"text/html; charset=us-ascii" />
<title>Test Execution</title>
<link rel="stylesheet" type="text/css" href=
"../../../stylesheets/book.css" />
</head>

<body><h2 id="TestExecutionandLifecycleExplained">Test Execution and Lifecycle Explained</h2><ol style="list-style: none;"><li><a href="#TestExecutionandLifecycleExplained">Test Execution and Lifecycle Explained</a></li><li><a href="#UITestCases">UI Test Cases</a></li><li><a href="#RunningTests">Running Tests</a></li><li><a href="#TestExecutionATaleofTwoThreads">Test Execution (A Tale of Two Threads)</a><ol style="list-style: none;"><li><a href="#SWTUIThread">SWT UI Thread</a></li><li><a href="#TestThread">Test Thread</a></li><li><a href="#BridgingtheThreadDivide">Bridging the Thread Divide</a></li></ol></li><li><a href="#TestLifecycle">Test Lifecycle</a><ol style="list-style: none;"><li><a href="#ViewingTestResults">Viewing Test Results</a></li><li><a href="#Screenshots">Screenshots</a></li></ol></li></ol><p><hr/></p><h2 id="UITestCases">UI Test Cases</h2><p>Test cases in WindowTester Pro subclasses of <code>UITestCaseSWT</code> (for SWT) or <code>UITestCaseSwing</code> (for Swing).  The classes are in turn specializations of JUnit&#8217;s <code>TestCase</code>.  For instance, the class hierarchy of <code>UITestCaseSWT</code> is summarized here:</p><p><img border="0" src="testCaseHierarchy.jpg"/></p><h2 id="RunningTests">Running Tests</h2><p>Since WindowTester Pro tests are <i>just JUnit tests</i>, this means that they can be run using standard JUnit test runners.  In other words, running a plug-in WindowTester Pro test is just like running any other PDE test.</p><p><img border="0" src="runAs.jpg"/></p><h2 id="TestExecutionATaleofTwoThreads">Test Execution (A Tale of Two Threads)</h2><p>WindowTester Pro test execution is a bit more complicated than standard JUnit tests.  The key to understanding test execution in WindowTester Pro is understanding its threading story.</p><h3 id="SWTUIThread">SWT UI Thread</h3><p>SWT follows the threading model supported directly by the operating system. The UI thread is the thread on which the Display is created and on which all widgets must be created and accessed.  If this invariant is violated an <code>SWTException</code> is thrown signaling invalid thread access<sup class="footnote"><a href="#___fn1">1</a></sup>. </p><h3 id="TestThread">Test Thread</h3><p>WindowTester Pro tests execute a separate non-UI <i>test thread</i>.  This is crucial since the UI thread frequently blocks &#8212; for instance when it is in a modal context and is waiting for user input.  If tests did not have their own thread, WindowTester Pro would not be able to drive the UI when it is blocked.</p><h3 id="BridgingtheThreadDivide">Bridging the Thread Divide</h3><p>To avoid thread access violations, the user must take care to ensure that all access to UI resources is done on the UI thread.  The idiom for doing this is to create a <code>Runnable</code> and pass it to the <code>Display</code> for execution.  As an example, take the following which safely accesses the text content of a <code>Text</code> widget:</p><pre><code>String getText(final Text widget) {
	final String text[] = new String[1];
	Display.getDefault().syncExec(new Runnable() {
		public void run() {
			text[0] = widget.getText();
		}			
	});
	return text[0];
}
</code></pre><p></p><p>In a test, we could use such a method like this:</p><pre><code>IWidgetReference ref = (IWidgetReference) ui.find(new SWTWidgetLocator(Text.class));
Text text = (Text)ref.getWidget();
assertEquals("some text", getText(text));
</code></pre><p></p><p><i><strong>Note</strong> that a better way to handle this assertion is using a condition.  For more on conditions in the context of assertions see <a href="../../reference/assertions.html">here</a>.</i></p><h2 id="TestLifecycle">Test Lifecycle</h2><p>WindowTester Pro tests are bootstrapped and run by a standard JUnit test runner.</p><h3 id="ViewingTestResults">Viewing Test Results</h3><p>When a test is run in the IDE, it&#8217;s results are displayed in the JUnit test view.</p><p><img border="0" src="results.jpg"/></p><h3 id="Screenshots">Screenshots</h3><p>To help you troubleshoot test failures, WindowTester Pro automatically captures screen shots on test failures. These screen shots are emitted to a <code>wintest</code> sub-directory of the working Eclipse base directory. For instance, if your eclipse is located in <code>C:\dev\eclipse</code>, screenshots would appear in <code>C:\dev\eclipse\wintest</code>.</p><p>You can capture a new screenshot at any time during a test using the <code>ScreenCapture</code> utility class. Please see the <code>ScreenCapture</code> <a href="../../reference/javadoc/com/windowtester/runtime/util/ScreenCapture.html">javadoc</a> for more information on how this is done.</p><p><hr/></p><p id="___fn1" class="footnote"><sup>1</sup> For more on the SWT threading story see this <a href="http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/swt_threading.htm">document</a>.</p></body></html>